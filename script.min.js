const savedTheme=localStorage.getItem("theme");savedTheme?document.documentElement.setAttribute("data-theme",savedTheme):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&document.documentElement.setAttribute("data-theme","dark");function updateThemeIcon(){const e=document.querySelector(".theme-switch"),t=document.documentElement.getAttribute("data-theme");"dark"===t?e.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>':e.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>'}function toggleTheme(){const e=document.documentElement,t=e.getAttribute("data-theme"),a="dark"===t?"light":"dark";e.setAttribute("data-theme",a),localStorage.setItem("theme",a),updateThemeIcon()}document.addEventListener("DOMContentLoaded",()=>{updateThemeIcon();const e=new Date().getFullYear(),t=document.getElementById("current-year");t&&(t.textContent=e);const a=document.querySelectorAll(".tool-card"),l="data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"64\" height=\"64\" viewBox=\"0 0 64 64\"><rect width=\"64\" height=\"64\" fill=\"%23d0d0d0\"/></svg>";a.forEach(e=>{const t=e.href,a=e.querySelector(".tool-logo");if(t&&a&&t!==window.location.href+"#"){try{const n=new URL(t,window.location.origin).href,o=new URL(n).origin,c=`https://www.google.com/s2/favicons?sz=64&domain_url=${encodeURIComponent(o)}`;a.src=c,a.onerror=function(){this.onerror=null,this.src=l}}catch(e){console.error(`Failed to process URL: ${t}`,e),a.src=l}}else a&&(a.src=l)});const n=document.getElementById("tools-container"),o=document.getElementById("favorites-section"),c=document.getElementById("favorites-grid"),d=document.getElementById("no-favorites-message"),i=document.querySelectorAll(".tool-card");function r(){const e=localStorage.getItem("aiHubFavorites");return e?JSON.parse(e):[]}function s(e){localStorage.setItem("aiHubFavorites",JSON.stringify(e))}function u(e){return e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}function m(){const e=r();c.innerHTML="",document.querySelectorAll(".favorite-btn").forEach(e=>{e.textContent="☆",e.classList.remove("active"),e.setAttribute("aria-label","Add to favorites")}),0===e.length?(o.style.display="none",d.style.display="block"): (o.style.display="block",d.style.display="none",e.forEach(e=>{const a=document.querySelector(`.tool-card[data-tool-id="${e}"]`);if(a){const l=a.cloneNode(!0),n=l.querySelector(".favorite-btn");n&&(n.textContent="★",n.classList.add("active"),n.setAttribute("aria-label","Remove from favorites")),t.appendChild(l);const o=a.querySelector(".favorite-btn");o&&(o.textContent="★",o.classList.add("active"),o.setAttribute("aria-label","Remove from favorites"))}}))}function g(e){let t=r();const a=t.indexOf(e);a>-1?t.splice(a,1):t.push(e),s(t),m()}i.forEach(e=>{if(!e.dataset.toolId){const t=e.querySelector(".tool-name"),a=t?t.textContent:e.href;a&&(e.dataset.toolId=u(a))}if(!e.querySelector(".favorite-btn")){const t=document.createElement("button");t.className="favorite-btn",t.setAttribute("aria-label","Add to favorites"),t.innerHTML="☆";const a=e.querySelector(".tool-logo");a?e.insertBefore(t,a):e.prepend(t)}}),document.querySelector(".container").addEventListener("click",e=>{if(e.target.classList.contains("favorite-btn")){e.preventDefault(),e.stopPropagation();const t=e.target.closest(".tool-card");if(t&&t.dataset.toolId){let e=l();const a=e.indexOf(t.dataset.toolId);a>-1?e.splice(a,1):e.push(t.dataset.toolId),n(e),c()}}}),m(),window.addEventListener("load",function(){console.log("Window fully loaded - initializing all features");const e=function(){const e=14,t=new Date,a=document.querySelectorAll(".tool-card"),l=[];return a.forEach(a=>{const n=a.getAttribute("data-added");if(n){const o=new Date(n),c=Math.abs(t-o),d=Math.ceil(c/864e5);d<=e&&l.push({element:a,date:o})}}),l}();(function(e){e.forEach(e=>{if(!e.element.querySelector(".new-tool-badge")){const t=document.createElement("span");t.className="new-tool-badge",t.textContent="NEW",e.element.appendChild(t)}})})(e),(function(e){if(e.length>0){const t=document.getElementById("recently-added-section");t&&t.remove();const a=[...e].sort((e,t)=>t.date-a.date),l=document.createElement("div");l.className="category-section",l.id="recently-added-section";const n='\n                <h2 class="category-title">\n                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path>\n                    </svg>\n                    Recently Added\n                </h2>\n            ';l.innerHTML=n;const o=document.createElement("div");o.className="tools-grid";const c=new Set;a.forEach(e=>{const t=e.element.dataset.toolId;if(!c.has(t)){const a=e.element.cloneNode(!0);o.appendChild(a),t&&c.add(t)}}),l.appendChild(o);const d=document.getElementById("tools-container"),i=document.querySelector(".container");d&&i&&i.insertBefore(l,d)}})(e);const t=document.getElementById("search-input"),a=Array.from(document.querySelectorAll(".tool-card")),l=Array.from(document.querySelectorAll(".category-section"));let c=document.createElement("div");c.id="no-results-notice",c.style.display="none",c.style.textAlign="center",c.style.padding="20px",c.style.margin="20px auto",c.style.color="var(--text-color)",c.style.backgroundColor="var(--card-background)",c.style.borderRadius="12px",c.style.boxShadow="0 2px 10px var(--shadow-color)",c.style.maxWidth="600px",c.textContent="No results found. Try a different search term.",document.querySelector(".container").insertBefore(c,document.getElementById("tools-container"));const d=function(){const n=t.value.trim().toLowerCase();if(!n)return a.forEach(e=>e.style.display=""),l.forEach(e=>e.style.display=""),c.style.display="none",void 0;let o=0;a.forEach(e=>{const t=e.querySelector(".tool-name")?.textContent?.toLowerCase()||"",a=e.querySelector("img")?.getAttribute("alt")?.toLowerCase()||"",d=e.getAttribute("href")?.toLowerCase()||"";if("new"===n){const t=e.hasAttribute("data-added");return void(t?(e.style.display="",o++):e.style.display="none")}const i=/\bgemini\b/i,r=n.match(i)&&(t.match(i)||a.match(i)),s=r||t.includes(n)||a.includes(n)||d.includes(n);s?(e.style.display="",o++):e.style.display="none"}),l.forEach(e=>{const t=e.querySelectorAll('.tool-card:not([style*="display: none"])');t.length>0?e.style.display="":e.style.display="none"}),0===o?c.style.display="block":c.style.display="none"};t&&(t.addEventListener("keypress",function(e){"Enter"===e.key&&d()}),t.addEventListener("input",function(){let e;clearTimeout(e),e=setTimeout(d,300)}))});