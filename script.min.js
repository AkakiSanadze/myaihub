const savedTheme=localStorage.getItem("theme");if(savedTheme){document.documentElement.setAttribute("data-theme",savedTheme)}else{if(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches){document.documentElement.setAttribute("data-theme","dark")}}function updateThemeIcon(){const themeSwitch=document.querySelector(".theme-switch");const currentTheme=document.documentElement.getAttribute("data-theme");if(currentTheme==="dark"){themeSwitch.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>'}else{themeSwitch.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>'}}function toggleTheme(){const html=document.documentElement;const currentTheme=html.getAttribute("data-theme");const newTheme=currentTheme==="dark"?"light":"dark";html.setAttribute("data-theme",newTheme);localStorage.setItem("theme",newTheme);updateThemeIcon()}document.addEventListener("DOMContentLoaded",(()=>{updateThemeIcon();const currentYear=(new Date).getFullYear();const yearSpan=document.getElementById("current-year");if(yearSpan){yearSpan.textContent=currentYear}const toolCards=document.querySelectorAll(".tool-card");const placeholderIcon='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 64 64"><rect width="64" height="64" fill="%23d0d0d0"/></svg>';toolCards.forEach((card=>{const link=card.href;const img=card.querySelector(".tool-logo");if(link&&img&&link!==window.location.href+"#"){try{const absoluteLink=new URL(link,window.location.origin).href;const url=new URL(absoluteLink);const domain=url.origin;const faviconUrl=`https://www.google.com/s2/favicons?sz=64&domain_url=${encodeURIComponent(domain)}`;img.src=faviconUrl;img.onerror=function(){this.onerror=null;this.src=placeholderIcon}}catch(e){console.error(`Failed to process URL: ${link}`,e);img.src=placeholderIcon}}else if(img){img.src=placeholderIcon}}));const toolsContainer=document.getElementById("tools-container");const favoritesSection=document.getElementById("favorites-section");const favoritesGrid=document.getElementById("favorites-grid");const noFavoritesMessage=document.getElementById("no-favorites-message");const allToolCards=document.querySelectorAll(".tool-card");const FAVORITES_KEY="aiHubFavorites";function getFavorites(){const favorites=localStorage.getItem(FAVORITES_KEY);return favorites?JSON.parse(favorites):[]}function saveFavorites(favorites){localStorage.setItem(FAVORITES_KEY,JSON.stringify(favorites))}function generateToolId(text){return text.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}function updateFavoritesUI(){const favorites=getFavorites();favoritesGrid.innerHTML="";document.querySelectorAll(".favorite-btn").forEach((btn=>{btn.textContent="☆";btn.classList.remove("active");btn.setAttribute("aria-label","Add to favorites")}));if(favorites.length===0){favoritesSection.style.display="none";noFavoritesMessage.style.display="block"}else{favoritesSection.style.display="block";noFavoritesMessage.style.display="none";favorites.forEach((toolId=>{const originalCard=document.querySelector(`.tool-card[data-tool-id="${toolId}"]`);if(originalCard){const clonedCard=originalCard.cloneNode(true);const clonedBtn=clonedCard.querySelector(".favorite-btn");if(clonedBtn){clonedBtn.textContent="★";clonedBtn.classList.add("active");clonedBtn.setAttribute("aria-label","Remove from favorites")}favoritesGrid.appendChild(clonedCard);const originalBtn=originalCard.querySelector(".favorite-btn");if(originalBtn){originalBtn.textContent="★";originalBtn.classList.add("active");originalBtn.setAttribute("aria-label","Remove from favorites")}}}))}}function toggleFavorite(toolId){let favorites=getFavorites();const index=favorites.indexOf(toolId);if(index>-1){favorites.splice(index,1)}else{favorites.push(toolId)}saveFavorites(favorites);updateFavoritesUI()}allToolCards.forEach((card=>{if(!card.dataset.toolId){const toolNameElement=card.querySelector(".tool-name");const idBase=toolNameElement?toolNameElement.textContent:card.href;if(idBase){card.dataset.toolId=generateToolId(idBase)}}if(!card.querySelector(".favorite-btn")){const favButton=document.createElement("button");favButton.className="favorite-btn";favButton.setAttribute("aria-label","Add to favorites");favButton.innerHTML="☆";const img=card.querySelector(".tool-logo");if(img){card.insertBefore(favButton,img)}else{card.prepend(favButton)}}}));document.querySelector(".container").addEventListener("click",(event=>{if(event.target.classList.contains("favorite-btn")){event.preventDefault();event.stopPropagation();const toolCard=event.target.closest(".tool-card");if(toolCard&&toolCard.dataset.toolId){toggleFavorite(toolCard.dataset.toolId)}}}));updateFavoritesUI();function findNewTools(){const NEW_DAYS=14;const today=new Date;const allTools=document.querySelectorAll(".tool-card");const recentlyAddedTools=[];allTools.forEach((tool=>{const addedDateStr=tool.getAttribute("data-added");if(addedDateStr){const addedDate=new Date(addedDateStr);const diffTime=Math.abs(today-addedDate);const diffDays=Math.ceil(diffTime/(1e3*60*60*24));if(diffDays<=NEW_DAYS){recentlyAddedTools.push({element:tool,date:addedDate})}}}));return recentlyAddedTools}function addNewBadgesToTools(newTools){newTools.forEach((toolInfo=>{if(!toolInfo.element.querySelector(".new-tool-badge")){const badge=document.createElement("span");badge.className="new-tool-badge";badge.textContent="NEW";toolInfo.element.appendChild(badge)}}))}function createRecentlyAddedSection(newTools){if(newTools.length>0){const existingSection=document.getElementById("recently-added-section");if(existingSection){existingSection.remove()}const sortedTools=[...newTools].sort(((a,b)=>b.date-a.date));const recentlyAddedSection=document.createElement("div");recentlyAddedSection.className="category-section";recentlyAddedSection.id="recently-added-section";const titleHTML=`\n                <h2 class="category-title">\n                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path>\n                    </svg>\n                    Recently Added\n                </h2>\n            `;recentlyAddedSection.innerHTML=titleHTML;const grid=document.createElement("div");grid.className="tools-grid";const addedToolIds=new Set;sortedTools.forEach((toolInfo=>{const toolId=toolInfo.element.dataset.toolId;if(!addedToolIds.has(toolId)){const clone=toolInfo.element.cloneNode(true);grid.appendChild(clone);if(toolId){addedToolIds.add(toolId)}}}));recentlyAddedSection.appendChild(grid);const toolsContainer=document.getElementById("tools-container");const container=document.querySelector(".container");if(toolsContainer&&container){container.insertBefore(recentlyAddedSection,toolsContainer)}}}window.addEventListener("load",(function(){console.log("Window fully loaded - initializing all features");const newTools=findNewTools();addNewBadgesToTools(newTools);createRecentlyAddedSection(newTools);const searchInput=document.getElementById("search-input");const allTools=Array.from(document.querySelectorAll(".tool-card"));const allCategories=Array.from(document.querySelectorAll(".category-section"));let noResultsNotice=document.createElement("div");noResultsNotice.id="no-results-notice";noResultsNotice.style.display="none";noResultsNotice.style.textAlign="center";noResultsNotice.style.padding="20px";noResultsNotice.style.margin="20px auto";noResultsNotice.style.color="var(--text-color)";noResultsNotice.style.backgroundColor="var(--card-background)";noResultsNotice.style.borderRadius="12px";noResultsNotice.style.boxShadow="0 2px 10px var(--shadow-color)";noResultsNotice.style.maxWidth="600px";noResultsNotice.textContent="No results found. Try a different search term.";document.querySelector(".container").insertBefore(noResultsNotice,document.getElementById("tools-container"));function filterTools(){const term=searchInput.value.trim().toLowerCase();console.log("Filtering for:",term);if(!term){allTools.forEach((tool=>tool.style.display=""));allCategories.forEach((category=>category.style.display=""));noResultsNotice.style.display="none";return}let matchCount=0;allTools.forEach((tool=>{const toolName=tool.querySelector(".tool-name")?.textContent?.toLowerCase()||"";const imgAlt=tool.querySelector("img")?.getAttribute("alt")?.toLowerCase()||"";const href=tool.getAttribute("href")?.toLowerCase()||"";if(term==="new"){const isMatch=tool.hasAttribute("data-added");if(isMatch){tool.style.display="";matchCount++}else{tool.style.display="none"}return}const geminiPattern=/\bgemini\b/i;const isGemini=term.match(geminiPattern)&&(toolName.match(geminiPattern)||imgAlt.match(geminiPattern));const isMatch=isGemini||toolName.includes(term)||imgAlt.includes(term)||href.includes(term);if(isMatch){tool.style.display="";matchCount++;console.log("Match found:",toolName||imgAlt)}else{tool.style.display="none"}}));allCategories.forEach((category=>{const visibleTools=category.querySelectorAll('.tool-card:not([style*="display: none"])');if(visibleTools.length>0){category.style.display=""}else{category.style.display="none"}}));if(matchCount===0){noResultsNotice.style.display="block"}else{noResultsNotice.style.display="none"}console.log(`Found ${matchCount} matches out of ${allTools.length} tools`)}if(searchInput){searchInput.addEventListener("keypress",(function(e){if(e.key==="Enter"){filterTools()}}));let debounceTimer;searchInput.addEventListener("input",(function(){clearTimeout(debounceTimer);debounceTimer=setTimeout(filterTools,300)}))}console.log("In-place filter functionality initialized successfully")}))}));